<script>
const form = document.getElementById('botForm');
const output = document.getElementById('output');

// Determine correct Netlify function path
const createBotPath = window.location.hostname.includes('localhost')
  ? '/netlify/functions/overpoweredbot'
  : '/.netlify/functions/overpoweredbot';

form.addEventListener('submit', async (e) => {
  e.preventDefault();
  const description = document.getElementById('description').value.trim();

  if (!description) {
    output.textContent = 'Please enter a description.';
    output.className = 'output error';
    return;
  }

  output.textContent = 'Creating bot...';
  output.className = 'output';

  try {
    const res = await fetch(createBotPath, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ description })
    });

    const data = await res.json();

    if (!res.ok || data.error) {
      output.textContent = `Error creating bot: ${data.error || 'Unknown error'}`;
      output.className = 'output error';
      return;
    }

    // ‚úÖ Simple success message with links to navigate
    output.innerHTML = `
      <strong>Bot Created Successfully!</strong><br>
      ID/Hash: ${data.hash || 'N/A'}<br>
      API Key: ${data.apiKey || 'Check Supabase'}<br>
      File: bot.js<br><br>
      <a href="/explore.html">üîç Explore Other Bots</a> |
      <a href="/index.html">‚öôÔ∏è Create Another Bot</a>
    `;
    output.className = 'output success';
    form.reset();

  } catch (err) {
    console.error(err);
    output.textContent = 'Failed to create bot.';
    output.className = 'output error';
  }
});
</script>
